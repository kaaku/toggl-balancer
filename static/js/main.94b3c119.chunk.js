(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{170:function(e,t,a){e.exports=a(381)},378:function(e,t,a){},381:function(e,t,a){"use strict";a.r(t);var n=a(65);Object(n.b)();var r=a(163),o=a.n(r),i=a(17),s=a(8),c=a.n(s),l=(a(208),a(152)),u=a(58),m=a(0),h=a.n(m),d=a(22),f=a.n(d);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var g=a(44),p=a(45),b=a(48),y=a(46),E=a(49),D=a(24),k=a(26),v=a.n(k),O=a(19),w=a.n(O),T=a(165),j=a(382),C=a(156),M=a.n(C),S=a(68),Y=a.n(S),A=a(72),R=a.n(A),B=a(69),P=a.n(B),x=a(154),I=a.n(x),N=a(153),_=a.n(N),z=a(155),F=a.n(z),V=a(70),q=a.n(V),L=a(71),H=a.n(L),U=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(b.a)(this,Object(y.a)(t).call(this,e))).state={apiToken:e.oldApiToken,rememberMe:!0},a.handleChange=a.handleChange.bind(Object(D.a)(Object(D.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(D.a)(Object(D.a)(a))),a.handleCancel=a.handleCancel.bind(Object(D.a)(Object(D.a)(a))),a}return Object(E.a)(t,e),Object(p.a)(t,[{key:"handleChange",value:function(e){this.setState({apiToken:e.target.value})}},{key:"handleSubmit",value:function(){var e=this.props.onClose,t=this.state;e({apiToken:t.apiToken,rememberMe:t.rememberMe})}},{key:"handleCancel",value:function(){(0,this.props.onClose)({})}},{key:"render",value:function(){var e=this,t=this.props,a=t.open,n=t.mandatory,r=this.state,o=r.apiToken,i=r.rememberMe;return h.a.createElement(Y.a,{open:a,disableBackdropClick:n,disableEscapeKeyDown:n,"aria-labelledby":"form-dialog-title"},h.a.createElement(_.a,{id:"form-dialog-title"},"Enter your Toggl API Token"),h.a.createElement(P.a,null,h.a.createElement(I.a,null,"Your Toggl time entries will be fetched using your API Token, which you can find from your"," ",h.a.createElement("a",{href:"https://www.toggl.com/app/profile",target:"_blank",rel:"noopener noreferrer"},"Toggl profile ",h.a.createElement(q.a,{fontSize:"small"},"open_in_new"))),h.a.createElement(H.a,{type:"password",autoFocus:!0,fullWidth:!0,margin:"dense",label:"API Token",value:o,onChange:this.handleChange}),h.a.createElement(F.a,{control:h.a.createElement(M.a,{color:"primary",checked:i,onChange:function(t,a){return e.setState({rememberMe:a})}}),label:"Remember me"})),h.a.createElement(R.a,null,!n&&h.a.createElement(v.a,{color:"primary",onClick:this.handleCancel},"Cancel"),h.a.createElement(v.a,{variant:"contained",color:"primary",onClick:this.handleSubmit,disabled:!o},"Submit")))}}]),t}(m.Component);U.defaultProps={oldApiToken:"",open:!0,mandatory:!1};var W=Object(i.withStyles)({},{withTheme:!0})(U),J=a(164),G=a(11),K=a(20),$=a.n(K),Q=function(e){var t=e.duration,a=e.useColors,n=e.textProps,r=0===t?"":t>0?"+":"-",o=c.a.duration(Math.abs(t),"seconds"),i="".concat(Math.floor(o.asHours()),":").concat(o.minutes().toString().padStart(2,"0"));return a&&(n.color=t<0?"error":"primary"),h.a.createElement($.a,n,r,i)};Q.defaultProps={useColors:!1,textProps:{}};var X=Object(i.withStyles)({},{withTheme:!0})(Q),Z=a(7),ee=a.n(Z),te=a(34),ae=a.n(te),ne=Object(i.withStyles)(function(e){return{calendarCell:{padding:10,height:"100%"},disabled:{backgroundColor:e.palette.grey[200]}}},{withTheme:!0})(function(e){for(var t=e.year,a=e.month,n=e.data,r=e.defaultContent,o=e.classes,i=c()({year:t,month:a-1,day:1}),s=c()(i).startOf("week"),l=c()(i).endOf("month").startOf("day"),u=c()(l).endOf("week").startOf("day"),m=[],d=[],f=Math.round(c.a.duration(u.diff(s)).asDays())+1;m.length<f;)m.push(c()(s).add(m.length,"days").format("YYYY-MM-DD"));for(;m.length>0;)d.push(m.splice(0,7));return h.a.createElement(h.a.Fragment,null,d.map(function(e){return h.a.createElement(w.a,{container:!0,spacing:16,key:c()(e[0]).week()},e.map(function(e){return h.a.createElement(w.a,{item:!0,xs:!0,key:e},h.a.createElement(ae.a,{className:ee()(o.calendarCell,Object(G.a)({},o.disabled,c()(e).month()+1!==a))},h.a.createElement($.a,{variant:"overline",gutterBottom:!0},c()(e).format("DD")),n[e]&&n[e],!n[e]&&c()(e).month()+1===a&&r))}))}))});function re(e,t){return Object.keys(e).filter(function(e){return c()(e).month()===t}).reduce(function(t,a){return Object.assign(t,Object(G.a)({},a,e[a]))},{})}function oe(e){return Object.assign.apply(Object,[{}].concat(Object(J.a)(Object.keys(e).map(function(t){return Object(G.a)({},t,(a=e[t],h.a.createElement(X,{duration:a.duration,useColors:!0,textProps:{variant:"h6",align:"center"}})));var a}))))}var ie=Object(i.withStyles)(function(e){return{root:{padding:10*e.spacing.unit}}},{withTheme:!0})(function(e){var t=e.startDate,a=e.endDate,n=e.timeEntriesByDate,r=e.classes;if(!t.isAfter(a)){for(var o=[],i=c()(t).startOf("month");i.isBefore(a);){var s=re(n,i.month());o.push({firstDayOfMonth:i,totalDiff:Object.values(s).reduce(function(e,t){return e+t.duration},0),monthViewData:oe(s)}),i=c()(i).add(1,"month")}return h.a.createElement(w.a,{container:!0,justify:"center",spacing:40,className:r.root},o.map(function(e){var t=e.firstDayOfMonth,a=e.totalDiff,n=e.monthViewData;return h.a.createElement(w.a,{item:!0,xs:12,lg:6,key:t.format("YYYY-MM")},h.a.createElement(w.a,{container:!0,justify:"space-between"},h.a.createElement(w.a,{item:!0},h.a.createElement($.a,{variant:"h2",gutterBottom:!0},t.format("MMMM YYYY"))),h.a.createElement(w.a,{item:!0},h.a.createElement(X,{duration:a,useColors:!0,textProps:{variant:"h2",gutterBottom:!0}}))),h.a.createElement(ne,{year:t.year(),month:t.month()+1,data:n,defaultContent:h.a.createElement($.a,{variant:"h6",color:"textSecondary",align:"center"},"-")}))}))}}),se=[{title:"Last month",getDateRange:function(){return{startDate:c()().subtract(1,"month").startOf("month"),endDate:c()().startOf("month").subtract(1,"day")}}},{title:"This month",getDateRange:function(){return{startDate:c()().startOf("month"),endDate:c()().endOf("month").startOf("day")}},default:!0},{title:"This year",getDateRange:function(){return{startDate:c()().startOf("year"),endDate:c()().endOf("month").startOf("day")}}}],ce=Object(i.withStyles)(function(e){return{root:{padding:5*e.spacing.unit},quickSelections:{marginTop:2*e.spacing.unit}}},{withTheme:!0})(function(e){var t=e.startDate,a=e.endDate,n=e.onChange,r=e.classes,o=c()().year();return h.a.createElement(ae.a,{className:r.root},h.a.createElement(w.a,{container:!0,justify:"space-evenly",spacing:40},h.a.createElement(w.a,{item:!0},h.a.createElement(u.a,{label:"From",format:t&&t.year()!==o?"MMMM Do, YYYY":"MMMM Do",value:t,maxDate:a,autoOk:!0,showTodayButton:!0,onChange:function(e){return n({startDate:e,endDate:a})}})),h.a.createElement(w.a,{item:!0},h.a.createElement(u.a,{label:"To",format:a&&a.year()!==o?"MMMM Do, YYYY":"MMMM Do",value:a,minDate:t,autoOk:!0,showTodayButton:!0,onChange:function(e){return n({startDate:t,endDate:e})}}))),h.a.createElement(w.a,{container:!0,justify:"space-evenly",spacing:40,className:r.quickSelections},se.map(function(e){return h.a.createElement(w.a,{item:!0,key:e.title},h.a.createElement(v.a,{onClick:function(){return n(e.getDateRange())},size:"small"},e.title))})))}),le=se.find(function(e){return e.default}).getDateRange(),ue=c.a.duration("7:30").asSeconds();function me(e){return e.map(function(e){return Object.assign(e,{start:c()(e.start),end:c()(e.end),duration:e.duration<0?c()().unix()+e.duration:e.duration,isRunning:e.duration<0})}).sort(function(e,t){return e.start.diff(t.start)}).reduce(function(e,t){var a=c()(t.start).format("YYYY-MM-DD"),n=e[a]||{timeEntries:[],duration:-ue,hasRunningEntry:!1};return n.timeEntries.push(t),n.duration+=t.duration,n.hasRunningEntry=n.hasRunningEntry||t.isRunning,Object.assign(e,Object(G.a)({},a,n))},{})}var he=function(e,t,a){if(!e&&!t)throw Error("Either start date or end date is required");if(!a)throw Error("API token is required");var n=e?c()(e).startOf("day"):null,r=t?c()(t).add(1,"day").startOf("day"):null;if(n&&!n.isValid()||r&&!r.isValid())throw Error("Start date and/or end date were invalid");var o=new URL("https://www.toggl.com/api/v8/time_entries"),i={};return n&&(i.start_date=n.toISOString()),r&&(i.end_date=r.toISOString()),o.search=new URLSearchParams(i),fetch(o,{method:"GET",headers:new Headers({Authorization:"Basic ".concat(btoa("".concat(a,":api_token"))),"Content-Type":"application/json"})}).catch(function(){throw Error("Failed to fetch time entries, check your internet connection")}).then(function(e){if(e.ok)return e.json();if(403===e.status)throw Error("Toggl authentication failed, maybe the API token is incorrect?");throw Error("Toggl responded with an unknown error (HTTP ".concat(e.status,")"))}).then(me)},de=a(162),fe=a.n(de),ge=a(161),pe=function(e){var t=e.size,a=e.visible,n=e.classes;return a?h.a.createElement(fe.a,{title:"You have a running time entry",placement:"top"},h.a.createElement(q.a,{fontSize:t,className:n.root},"fiber_manual_record")):null};pe.defaultProps={size:"default",visible:!0};var be=Object(i.withStyles)(function(e){return{root:{color:ge.red[500],marginLeft:2*e.spacing.unit,verticalAlign:"top",animation:"blinker 2s cubic-bezier(0.46, 0.03, 0.52, 0.96) infinite"}}},{withTheme:!0})(pe),ye=(a(378),function(e){function t(e){var a;Object(g.a)(this,t),a=Object(b.a)(this,Object(y.a)(t).call(this,e));var n=localStorage,r=n.apiToken,o=n.startDate,i=n.endDate,s=o&&i?{startDate:c()(o),endDate:c()(i)}:le;return a.state=Object.assign({apiToken:r,timeEntriesByDate:{},showApiTokenDialog:!r},s),a.handleDialogClose=a.handleDialogClose.bind(Object(D.a)(Object(D.a)(a))),a.handleDateRangeChange=a.handleDateRangeChange.bind(Object(D.a)(Object(D.a)(a))),a}return Object(E.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.state.apiToken&&this.updateTimeEntries()}},{key:"componentDidUpdate",value:function(e,t){var a=this.state,n=a.startDate,r=a.endDate,o=a.apiToken;t.startDate===n&&t.endDate===r&&t.apiToken===o||this.updateTimeEntries()}},{key:"updateTimeEntries",value:function(){var e=this,t=this.state,a=t.startDate,n=t.endDate,r=t.apiToken;try{he(a,n,r).then(function(t){return e.setState({timeEntriesByDate:t,error:void 0})},function(t){return e.setState({timeEntriesByDate:{},error:t.message})})}catch(i){var o=i.message;this.setState({error:o})}}},{key:"handleDialogClose",value:function(e){var t=e.apiToken,a=e.rememberMe,n={showApiTokenDialog:!1};t&&(a?localStorage.setItem("apiToken",t):localStorage.removeItem("apiToken"),Object.assign(n,{apiToken:t})),this.setState(n)}},{key:"handleDateRangeChange",value:function(e){Object.keys(e).forEach(function(t){return localStorage.setItem(t,e[t].format("YYYY-MM-DD"))}),this.setState(e)}},{key:"render",value:function(){var e=this,t=this.state,a=t.startDate,n=t.endDate,r=t.apiToken,o=t.showApiTokenDialog,i=t.timeEntriesByDate,s=t.error,c=this.props.classes;if(!r)return h.a.createElement(W,{mandatory:!0,onClose:this.handleDialogClose});var l=Object.values(i).reduce(function(e,t){return e+t.duration},0),u=Object.values(i).some(function(e){return e.hasRunningEntry});return h.a.createElement(h.a.Fragment,null,h.a.createElement(W,{open:o,mandatory:!1,oldApiToken:r,onClose:this.handleDialogClose}),h.a.createElement(v.a,{className:c.changeApiToken,color:"primary",onClick:function(){return e.setState({showApiTokenDialog:!0})}},"Change API Token"),h.a.createElement(w.a,{container:!0,justify:"center",className:c.dateSelectorContainer},h.a.createElement(w.a,{item:!0},h.a.createElement(ce,{startDate:a,endDate:n,onChange:this.handleDateRangeChange})),!a.isSame(n,"month")&&h.a.createElement(w.a,{item:!0,xs:12},h.a.createElement(j.a,{variant:"h2",align:"center",className:c.totalTimeDiff},"Total: ",h.a.createElement(X,{duration:l,useColors:!0,textProps:{variant:"inherit",inline:!0}}),h.a.createElement(be,{size:"large",visible:u}))),s&&h.a.createElement(w.a,{item:!0},h.a.createElement(T.a,{className:c.errorNotification,message:s}))),Object.keys(i).length>0&&h.a.createElement(ie,{startDate:a,endDate:n,timeEntriesByDate:i}))}}]),t}(m.Component)),Ee=Object(i.withStyles)(function(e){return{changeApiToken:{position:"absolute",top:2*e.spacing.unit,right:2*e.spacing.unit},dateSelectorContainer:{marginTop:5*e.spacing.unit},totalTimeDiff:{marginTop:3*e.spacing.unit},errorNotification:{marginTop:3*e.spacing.unit,backgroundColor:e.palette.error.main}}},{withTheme:!0})(ye);c.a.locale("en-gb");var De=Object(i.createMuiTheme)({typography:{useNextVariants:!0}});f.a.render(h.a.createElement(n.a,{theme:De},h.a.createElement(o.a,null),h.a.createElement(u.b,{utils:l.a},h.a.createElement(Ee,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[170,2,1]]]);
//# sourceMappingURL=main.94b3c119.chunk.js.map